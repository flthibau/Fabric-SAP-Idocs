// Validation queries to verify IDoc ingestion

// 1. Count total messages received
idoc_raw 
| count

// 2. Display the 10 most recent messages
idoc_raw 
| top 10 by timestamp desc
| project timestamp, idoc_type, message_type, sap_system, docnum=control.docnum

// 3. Count by IDoc type
idoc_raw 
| summarize Count=count() by idoc_type
| order by Count desc

// 4. Count by message type
idoc_raw 
| summarize Count=count() by message_type
| order by Count desc

// 5. Check timestamps (should be recent)
idoc_raw 
| summarize 
    FirstMessage = min(timestamp),
    LastMessage = max(timestamp),
    TotalCount = count()

// 6. View complete message (see all fields)
idoc_raw 
| take 1

// 7. Use created helper functions
GetRecentIDocs(1) // IDocs from the last hour

// 8. Check segments (detailed data)
idoc_raw
| take 1
| project idoc_type, docnum=control.docnum, data
