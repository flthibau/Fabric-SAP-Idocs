{
  "dataProductId": "a4f24a45-3443-4f87-a46b-1d4b0b00dce4",
  "domainId": "041de34f-62cf-4c8a-9a17-d1cc823e9538",
  "totalRules": 16,
  "rulesByDimension": {
    "Completeness": 3,
    "Validity": 6,
    "Uniqueness": 3,
    "Timeliness": 1,
    "Consistency": 2,
    "Accuracy": 1
  },
  "rulesByPriority": {
    "Critical": 11,
    "High": 4,
    "Medium": 1
  },
  "rulesByLayer": {
    "Bronze": 4,
    "Silver": 11,
    "Cross-Layer": 1
  },
  "rules": [
    {
      "id": "39072a82-2d47-48f7-82a4-f760d7c060f1",
      "name": "BRZ-001: Message Structure Completeness",
      "description": "Every IDoc message must have control and data segments",
      "qualityDimension": "Completeness",
      "priority": "Critical",
      "targetTable": "idoc_raw",
      "dataLayer": "Bronze",
      "validationQuery": "\n            idoc_raw\n            | where isnull(control) or isnull(data)\n            | summarize failed_count = count()\n            | extend status = iff(failed_count == 0, \"Pass\", \"Fail\")\n            | project status, failed_count, message = strcat(failed_count, \" messages missing structure\")\n        ",
      "targetThreshold": 0,
      "failureAction": "Alert data engineering team",
      "businessImpact": "Cannot process messages without structure",
      "createdAt": "2025-10-29T11:35:29.560458Z",
      "status": "Active"
    },
    {
      "id": "8b865477-17c2-4514-8f05-f549c9124265",
      "name": "BRZ-002: Message Type Validity",
      "description": "Message type must be in allowed list (ORDERS, SHPMNT, DESADV, WHSCON, INVOIC)",
      "qualityDimension": "Validity",
      "priority": "Critical",
      "targetTable": "idoc_raw",
      "dataLayer": "Bronze",
      "validationQuery": "\n            idoc_raw\n            | where message_type !in ('ORDERS', 'SHPMNT', 'DESADV', 'WHSCON', 'INVOIC')\n            | summarize failed_count = count()\n            | extend status = iff(failed_count == 0, \"Pass\", \"Fail\")\n            | project status, failed_count, message = strcat(failed_count, \" unknown message types\")\n        ",
      "targetThreshold": 0,
      "failureAction": "Quarantine message, investigate source",
      "businessImpact": "Unknown message types cannot be processed",
      "createdAt": "2025-10-29T11:35:29.562940Z",
      "status": "Active"
    },
    {
      "id": "094f2b77-bb7c-4871-a179-805a04ba35ce",
      "name": "BRZ-003: IDoc Number Uniqueness",
      "description": "Each IDoc number must be unique",
      "qualityDimension": "Uniqueness",
      "priority": "Critical",
      "targetTable": "idoc_raw",
      "dataLayer": "Bronze",
      "validationQuery": "\n            idoc_raw\n            | summarize count() by idoc_number\n            | where count_ > 1\n            | summarize duplicate_count = count()\n            | extend status = iff(duplicate_count == 0, \"Pass\", \"Fail\")\n            | project status, failed_count = duplicate_count, message = strcat(duplicate_count, \" duplicate IDoc numbers\")\n        ",
      "targetThreshold": 0,
      "failureAction": "Deduplicate, keep first occurrence",
      "businessImpact": "Duplicate processing causes data inflation",
      "createdAt": "2025-10-29T11:35:29.565580Z",
      "status": "Active"
    },
    {
      "id": "905cf6db-b4a5-40f8-b11b-256186819cec",
      "name": "BRZ-004: Ingestion Timeliness",
      "description": "Messages ingested within 30 seconds of Event Hub receipt",
      "qualityDimension": "Timeliness",
      "priority": "High",
      "targetTable": "idoc_raw",
      "dataLayer": "Bronze",
      "validationQuery": "\n            idoc_raw\n            | extend latency_seconds = datetime_diff('second', ingestion_time(), todatetime(timestamp))\n            | where latency_seconds > 30\n            | summarize late_count = count(), max_latency = max(latency_seconds)\n            | extend late_pct = late_count * 100.0 / toscalar(idoc_raw | count())\n            | extend status = iff(late_pct <= 5.0, \"Pass\", \"Fail\")\n            | project status, failed_count = late_count, message = strcat(round(late_pct, 2), \"% late messages, max latency: \", max_latency, \"s\")\n        ",
      "targetThreshold": 5.0,
      "failureAction": "Investigate Eventstream lag",
      "businessImpact": "Real-time SLA degradation",
      "createdAt": "2025-10-29T11:35:29.567592Z",
      "status": "Active"
    },
    {
      "id": "8b86906a-8c99-4d51-8a75-7feea7578fc7",
      "name": "SLV-ORD-001: Order Number Mandatory",
      "description": "Every order must have an order number",
      "qualityDimension": "Completeness",
      "priority": "Critical",
      "targetTable": "idoc_orders_silver",
      "dataLayer": "Silver",
      "validationQuery": "\n            idoc_orders_silver\n            | where isempty(order_number) or isnull(order_number)\n            | summarize failed_count = count()\n            | extend status = iff(failed_count == 0, \"Pass\", \"Fail\")\n            | project status, failed_count, message = strcat(failed_count, \" orders missing order number\")\n        ",
      "targetThreshold": 0,
      "failureAction": "Reject record, alert business team",
      "businessImpact": "Cannot track or reference orders",
      "createdAt": "2025-10-29T11:35:29.569990Z",
      "status": "Active"
    },
    {
      "id": "0704e138-d99b-435f-b42b-612c0215ee89",
      "name": "SLV-ORD-002: Customer ID Mandatory",
      "description": "Every order must reference a customer",
      "qualityDimension": "Completeness",
      "priority": "Critical",
      "targetTable": "idoc_orders_silver",
      "dataLayer": "Silver",
      "validationQuery": "\n            idoc_orders_silver\n            | where isempty(customer_id) or isnull(customer_id)\n            | summarize failed_count = count()\n            | extend status = iff(failed_count == 0, \"Pass\", \"Fail\")\n            | project status, failed_count, message = strcat(failed_count, \" orders missing customer ID\")\n        ",
      "targetThreshold": 0,
      "failureAction": "Reject record",
      "businessImpact": "Cannot attribute revenue or fulfill orders",
      "createdAt": "2025-10-29T11:35:29.572274Z",
      "status": "Active"
    },
    {
      "id": "5ad7996a-d35c-4648-8c12-b05ca9045d8f",
      "name": "SLV-ORD-003: Date Consistency",
      "description": "Requested delivery date must be after order date",
      "qualityDimension": "Consistency",
      "priority": "High",
      "targetTable": "idoc_orders_silver",
      "dataLayer": "Silver",
      "validationQuery": "\n            idoc_orders_silver\n            | where requested_delivery_date <= order_date\n            | summarize failed_count = count()\n            | extend status = iff(failed_count == 0, \"Pass\", \"Fail\")\n            | project status, failed_count, message = strcat(failed_count, \" orders with invalid date logic\")\n        ",
      "targetThreshold": 0,
      "failureAction": "Correct data, alert business",
      "businessImpact": "Illogical business logic",
      "createdAt": "2025-10-29T11:35:29.574769Z",
      "status": "Active"
    },
    {
      "id": "b764c98e-3f2b-428c-8214-faca6f37ba4f",
      "name": "SLV-ORD-004: Amount Validity",
      "description": "Total amount must be positive",
      "qualityDimension": "Validity",
      "priority": "Critical",
      "targetTable": "idoc_orders_silver",
      "dataLayer": "Silver",
      "validationQuery": "\n            idoc_orders_silver\n            | where total_amount <= 0\n            | summarize failed_count = count()\n            | extend status = iff(failed_count == 0, \"Pass\", \"Fail\")\n            | project status, failed_count, message = strcat(failed_count, \" orders with invalid amounts\")\n        ",
      "targetThreshold": 0,
      "failureAction": "Quarantine order, manual review",
      "businessImpact": "Financial reporting errors",
      "createdAt": "2025-10-29T11:35:29.576878Z",
      "status": "Active"
    },
    {
      "id": "9d3aea0f-890b-43d9-b371-1bd0f3003e79",
      "name": "SLV-SHP-001: Shipment Number Uniqueness",
      "description": "Each shipment number must be unique",
      "qualityDimension": "Uniqueness",
      "priority": "Critical",
      "targetTable": "idoc_shipments_silver",
      "dataLayer": "Silver",
      "validationQuery": "\n            idoc_shipments_silver\n            | summarize count() by shipment_number\n            | where count_ > 1\n            | summarize duplicate_count = count()\n            | extend status = iff(duplicate_count == 0, \"Pass\", \"Fail\")\n            | project status, failed_count = duplicate_count, message = strcat(duplicate_count, \" duplicate shipment numbers\")\n        ",
      "targetThreshold": 0,
      "failureAction": "Deduplicate, alert IT",
      "businessImpact": "Double-counting shipments",
      "createdAt": "2025-10-29T11:35:29.578744Z",
      "status": "Active"
    },
    {
      "id": "6c02b813-a4da-4fc3-b09e-a59e56f25428",
      "name": "SLV-SHP-002: Carrier Code Validity",
      "description": "Carrier code must be in master data",
      "qualityDimension": "Validity",
      "priority": "High",
      "targetTable": "idoc_shipments_silver",
      "dataLayer": "Silver",
      "validationQuery": "\n            let valid_carriers = datatable(carrier_code:string) [\"FEDEX\", \"UPS\", \"DHL\", \"USPS\", \"XPO\", \"CARRIER-FEDEX-GRO\", \"CARRIER-UPS\", \"CARRIER-DHL-EXPRE\"];\n            idoc_shipments_silver\n            | where carrier_id !in (valid_carriers) and carrier_code !in (valid_carriers)\n            | summarize failed_count = count()\n            | extend failed_pct = failed_count * 100.0 / toscalar(idoc_shipments_silver | count())\n            | extend status = iff(failed_pct <= 1.0, \"Pass\", \"Fail\")\n            | project status, failed_count, message = strcat(round(failed_pct, 2), \"% unknown carriers\")\n        ",
      "targetThreshold": 1.0,
      "failureAction": "Alert transportation team to update master data",
      "businessImpact": "Cannot track carrier performance",
      "createdAt": "2025-10-29T11:35:29.580650Z",
      "status": "Active"
    },
    {
      "id": "b0e7ca3c-cdb2-4d5e-b50e-c5bee4e26e68",
      "name": "SLV-SHP-003: Transit Time Reasonableness",
      "description": "Transit time must be between 0 and 720 hours (30 days)",
      "qualityDimension": "Validity",
      "priority": "Medium",
      "targetTable": "idoc_shipments_silver",
      "dataLayer": "Silver",
      "validationQuery": "\n            idoc_shipments_silver\n            | where transit_time_hours < 0 or transit_time_hours > 720\n            | summarize failed_count = count()\n            | extend status = iff(failed_count == 0, \"Pass\", \"Fail\")\n            | project status, failed_count, message = strcat(failed_count, \" shipments with unreasonable transit times\")\n        ",
      "targetThreshold": 0,
      "failureAction": "Investigate date calculation logic",
      "businessImpact": "Performance metrics unreliable",
      "createdAt": "2025-10-29T11:35:29.582715Z",
      "status": "Active"
    },
    {
      "id": "a08e0abd-24ac-4f37-822b-870a6b347ff3",
      "name": "SLV-WHS-001: Movement Type Validity",
      "description": "Movement type must be GR, GI, Transfer, or Count",
      "qualityDimension": "Validity",
      "priority": "Critical",
      "targetTable": "idoc_warehouse_silver",
      "dataLayer": "Silver",
      "validationQuery": "\n            idoc_warehouse_silver\n            | where movement_type !in ('GR', 'GI', 'Transfer', 'Count')\n            | summarize failed_count = count()\n            | extend status = iff(failed_count == 0, \"Pass\", \"Fail\")\n            | project status, failed_count, message = strcat(failed_count, \" invalid movement types\")\n        ",
      "targetThreshold": 0,
      "failureAction": "Reject record, alert warehouse",
      "businessImpact": "Cannot classify inventory transactions",
      "createdAt": "2025-10-29T11:35:29.584817Z",
      "status": "Active"
    },
    {
      "id": "72721f13-e52d-4e3e-9bb3-cbc59e766909",
      "name": "SLV-WHS-002: Quantity Positivity",
      "description": "Quantity must be positive",
      "qualityDimension": "Validity",
      "priority": "Critical",
      "targetTable": "idoc_warehouse_silver",
      "dataLayer": "Silver",
      "validationQuery": "\n            idoc_warehouse_silver\n            | where quantity <= 0\n            | summarize failed_count = count()\n            | extend status = iff(failed_count == 0, \"Pass\", \"Fail\")\n            | project status, failed_count, message = strcat(failed_count, \" negative or zero quantities\")\n        ",
      "targetThreshold": 0,
      "failureAction": "Correct data, investigate source",
      "businessImpact": "Inventory accuracy compromised",
      "createdAt": "2025-10-29T11:35:29.587074Z",
      "status": "Active"
    },
    {
      "id": "1f363559-347b-4708-ac36-d71bdb45551c",
      "name": "SLV-INV-001: Invoice Number Uniqueness",
      "description": "Each invoice number must be unique",
      "qualityDimension": "Uniqueness",
      "priority": "Critical",
      "targetTable": "idoc_invoices_silver",
      "dataLayer": "Silver",
      "validationQuery": "\n            idoc_invoices_silver\n            | summarize count() by invoice_number\n            | where count_ > 1\n            | summarize duplicate_count = count()\n            | extend status = iff(duplicate_count == 0, \"Pass\", \"Fail\")\n            | project status, failed_count = duplicate_count, message = strcat(duplicate_count, \" duplicate invoice numbers\")\n        ",
      "targetThreshold": 0,
      "failureAction": "Critical alert to finance, investigate double-billing",
      "businessImpact": "Financial reporting errors, client disputes",
      "createdAt": "2025-10-29T11:35:29.589399Z",
      "status": "Active"
    },
    {
      "id": "6a6784bc-94cc-41ba-b19e-0220ab694fd8",
      "name": "SLV-INV-002: Amount Calculations",
      "description": "Total amount must equal subtotal + tax - discount + shipping",
      "qualityDimension": "Accuracy",
      "priority": "Critical",
      "targetTable": "idoc_invoices_silver",
      "dataLayer": "Silver",
      "validationQuery": "\n            idoc_invoices_silver\n            | extend calculated_total = subtotal_amount + tax_amount - discount_amount + shipping_charges\n            | where abs(total_amount - calculated_total) > 0.01\n            | summarize failed_count = count()\n            | extend status = iff(failed_count == 0, \"Pass\", \"Fail\")\n            | project status, failed_count, message = strcat(failed_count, \" invoices with calculation errors\")\n        ",
      "targetThreshold": 0,
      "failureAction": "Recalculate totals, alert finance",
      "businessImpact": "Revenue mis-statement",
      "createdAt": "2025-10-29T11:35:29.591680Z",
      "status": "Active"
    },
    {
      "id": "943d9151-1090-4f25-a3bc-0544c2676a7b",
      "name": "XLR-001: Bronze to Silver Reconciliation (Orders)",
      "description": "Silver order count must match Bronze (accounting for deduplication)",
      "qualityDimension": "Consistency",
      "priority": "High",
      "targetTable": "Cross-Layer",
      "dataLayer": "Cross-Layer",
      "validationQuery": "\n            let bronze_orders = idoc_raw | where message_type == 'ORDERS' | count;\n            let silver_orders = idoc_orders_silver | count;\n            print variance_pct = abs(todouble(silver_orders) - todouble(bronze_orders)) / todouble(bronze_orders) * 100\n            | extend status = iff(variance_pct <= 5.0, \"Pass\", \"Fail\")\n            | project status, failed_count = toint(variance_pct), message = strcat(\"Variance: \", round(variance_pct, 2), \"%\")\n        ",
      "targetThreshold": 5.0,
      "failureAction": "Investigate update policy failures",
      "businessImpact": "Data loss in transformation",
      "createdAt": "2025-10-29T11:35:29.593767Z",
      "status": "Active"
    }
  ],
  "createdAt": "2025-10-29T11:35:29.597239Z"
}